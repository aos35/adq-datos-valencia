6. Enriquecimiento Semántico y Grafo de Conocimiento
El enriquecimiento de datos se realiza mediante la vinculación semántica de los recursos locales con Wikidata, especialmente en el ámbito geográfico (distritos). Se han obtenido QIDs únicos para cada distrito, definido vocabularios y generado un grafo RDF en formato Turtle, enlazando entidades locales con sus equivalentes globales mediante schema:sameAs. Esto permite la interoperabilidad, el acceso a información externa y la corrección de errores de geometría, elevando el proyecto a la Web de Datos y facilitando la generación de visualizaciones avanzadas.
7. Visualización y Análisis de Resultados
Se han implementado tres visualizaciones clave:
- Mapa interactivo de contaminación por distritos (NO₂), integrando imágenes de Wikidata y datos del grafo RDF.
- Análisis temporal de NO₂ y PM10 (laborables vs. fin de semana), validando la hipótesis sobre el impacto del tráfico.
- Mapa de calor de ruido, identificando hotspots acústicos y patrones espaciales.
Las visualizaciones permiten identificar zonas críticas, analizar tendencias y validar hipótesis, mostrando el valor añadido de la integración de datos abiertos y semánticos. Se han documentado los desafíos de datos (cobertura de estaciones, geometrías corruptas) y las soluciones implementadas (recuperación desde RDF, uso de QIDs para imágenes).
8. Conclusiones y Recomendaciones
El análisis realizado demuestra la correlación entre tráfico y NO₂, la distribución desigual del ruido y el valor del enriquecimiento semántico. Se recomienda a las administraciones la adopción de medidas localizadas (gestión del tráfico, peatonalización, barreras acústicas) y la integración de datos abiertos para la toma de decisiones. Como líneas futuras, se propone mejorar la resolución de los datos, integrar nuevas fuentes (tráfico real) y automatizar los procesos de análisis y visualización.
9. Bibliografía y Fuentes
- Portal de datos abiertos del Ayuntamiento de Valencia (datos.gob.es)
- Wikidata (enriquecimiento semántico)
- Schema.org (vocabularios RDF)
- Pentaho Data Integration, MySQL Workbench, Python (pandas, folium, seaborn, rdflib, SPARQLWrapper)
- Documentación y recursos propios del proyecto
Introducción
Este proyecto tiene como objetivo principal la reutilización de datos y contenidos abiertos procedentes de instituciones públicas. A partir de varias fuentes de información, se pretende analizar, combinar y mejorar conjuntos de datos de distintas naturalezas, centrándonos en el ámbito de la calidad de vida urbana y el impacto medioambiental.
En el desarrollo del trabajo, vamos a abarcar el diseño e implementación de un almacén de datos, desde su modelo conceptual hasta su implementación técnica. Esto incluye la preparación y transformación de la información, destacando la resolución de retos geoespaciales mediante el uso de estándares semánticos para asegurar la máxima precisión en la asociación de datos.
Finalmente, se elaborarán visualizaciones que permitan responder preguntas concretas planteadas al inicio del proyecto, mostrando el valor añadido de la integración de datos abiertos para la generación de nuevo conocimiento y la toma de decisiones informadas en la planificación urbana y la mitigación de la contaminación acústica.

Definición del Proyecto Centrado en los Datos
2.1. Selección de la Temática y Dominio
La temática seleccionada para el desarrollo del proyecto se centra en las Ciudades Inteligentes (Smart Cities), enfocando el dominio en la Contaminación Ambiental y Acústica. Este problema es de gran relevancia actualmente, ya que el aumento del tráfico urbano y los niveles de ruido en determinadas zonas tienen un gran impacto en la vida de los ciudadanos y en el medio ambiente. El estudio se centrará concretamente en la ciudad de Valencia como objeto de análisis.
2.2. Identificación del Problema y Lienzo (4W)
Las grandes ciudades enfrentan importantes desafíos relacionados con la gestión de la movilidad y el control de los niveles de contaminación. Los atascos, el ruido del tráfico y la emisión de gases contaminantes constituyen un problema que afecta tanto a la salud pública como al bienestar general. Con este proyecto se busca realizar un análisis sobre datos abiertos enfocado en la detección de zonas con alta contaminación y ruido, la comprensión de su evolución en el tiempo y la propuesta de posibles medidas para contrarrestar los efectos mediante el uso inteligente de los datos.
La cuestión principal que guía este proyecto es determinar en qué medida afectan la densidad del tráfico y la movilidad urbana a los niveles de contaminación ambiental y acústica, y qué estrategias pueden aplicarse para reducirlos mediante el análisis de datos abiertos y el cruce de información geográfica.
El problema identificado involucra a diversas partes interesadas. Las autoridades municipales (Concejalías de Medio Ambiente y Movilidad) buscan la mejora de la calidad del aire y la reducción del ruido mediante políticas eficaces (Who). El problema radica en la desconexión espacial y la falta de un análisis integrado de las mediciones de ruido y los límites administrativos de los distritos, lo que impide una evaluación precisa del impacto (What). El contexto en el que se desarrolla este problema es en áreas urbanas de alta densidad, como sucede en el centro de Valencia (Where). La razón que motiva este estudio es la importancia de reducir la contaminación con el fin de mejorar el bienestar público, disminuir los efectos negativos ambientales y avanzar hacia modelos urbanos más sostenibles, impactando positivamente en la calidad de vida de los ciudadanos (Why).
2.3. Objetivos del Proyecto
Los objetivos que se pretenden alcanzar son principalmente tres. En primer lugar, se busca analizar la distribución geográfica y temporal de los niveles de contaminación ambiental y acústica en la ciudad seleccionada. El segundo objetivo es identificar patrones o correlaciones entre el tráfico, la movilidad urbana y los niveles de contaminación. Finalmente, se pretende proponer estrategias o soluciones basadas en los resultados obtenidos (por ejemplo, el rediseño de rutas, la promoción de movilidad sostenible o la delimitación de zonas de bajas emisiones) y visualizar los datos de forma interactiva para facilitar su interpretación y uso por parte de las administraciones y la ciudadanía.
2.4. Casos de Uso y Métricas Clave
Recapitulando los casos de uso, se han identificado algunos de interés que motivan el enfoque del proyecto. En primer lugar, la identificación de las zonas con mayor contaminación acústica y su evolución temporal, lo cual es crítico para la intervención. Además, se busca el análisis de la relación entre la intensidad del tráfico (flujo vehicular) y los niveles de contaminación ambiental. Por último, la generación de visualizaciones interactivas (mapas o dashboards) que muestren los niveles de ruido y contaminación con una granularidad geográfica (por distrito) que actualmente no está disponible.
En cuanto a las métricas clave, se considerarán los niveles medios de contaminación (NO₂, PM10, PM2.5) y los niveles de ruido (en decibelios, dB). Se abordará el flujo vehicular por hora o día, al igual que la variación temporal de los niveles de contaminación. Finalmente, una métrica de gran relevancia será el número de zonas críticas (Distritos) identificadas que superan los umbrales legales de decibelios, permitiendo una evaluación directa del impacto en función de los objetivos.

 Análisis y Evaluación de Necesidades de Datos
3.1. Análisis y Evaluación de Necesidades de Datos
Para alcanzar los objetivos del proyecto, se requiere información estructurada que permita analizar la distribución temporal y geográfica de la contaminación, detectar patrones de concentración y evaluar la influencia de la movilidad urbana. Los datos necesarios se clasifican en tres tipos principales: datos de contaminación ambiental (mediciones de gases contaminantes), datos de contaminación acústica (niveles de ruido medio) y datos de contexto geográfico y social (límites de distritos, población y, idealmente, flujo vehicular). Estos datos deben ser de naturaleza cuantitativa y contar con atributos geográficos (coordenadas o geometrías) para permitir la integración espacial y temporal requerida en el Data Mart. Todos los conjuntos de datos seleccionados proceden de fuentes abiertas del Ayuntamiento de Valencia, integradas en el portal nacional de datos abiertos (datos.gob.es), utilizando el formato CSV por su facilidad para el procesamiento, análisis y la ingesta mediante herramientas ETL como Pentaho Data Integration.
3.2. Conjuntos de Datos Seleccionados
Se han seleccionado dos conjuntos de datos principales que constituyen el núcleo del Data Mart, complementados con información geoespacial y demográfica (población y polígonos de distritos).
El primer conjunto de datos clave es el archivo "Datos diarios de calidad del aire 2004-2022". Este fichero contiene registros diarios de calidad del aire obtenidos en distintas estaciones de medición, incluyendo contaminantes cruciales como el dióxido de nitrógeno, partículas en suspensión, ozono, y otros. Sus campos principales son la fecha de medición, la estación, el tipo de contaminante y el nivel de concentración. Se detectó la presencia de valores nulos (NaN), los cuales se gestionarán aplicando técnicas de imputación utilizando el valor medio en casos apropiados, mientras que otros valores se mantendrán sin modificar para preservar la integridad del registro en situaciones de ausencia de medición.
El segundo conjunto de datos seleccionado es el "Mapa de ruido 24h", esencial para la dimensión acústica. Este archivo incluye mediciones de los niveles de ruido ambiental en diferentes zonas de la ciudad, definidas por una rejilla (grid). Las columnas principales son gridcode (nivel de ruido), grid (identificador único), geo_shape (la geometría del área en formato GeoJSON) y geo_point_2d (el punto central de la celda). Este dataset es de alta calidad, ya que las coordenadas y geometrías están correctamente definidas, permitiendo una integración precisa mediante funciones de búsqueda espacial.
3.3. Limitaciones, Refinamiento de Preguntas y Ficticios
A pesar de la alta calidad de los datos, se detectaron limitaciones. La principal es la disparidad en la resolución espacial y temporal. Las estaciones de calidad del aire y las zonas de medición de ruido no siempre coinciden geográficamente, lo que dificulta una correlación directa entre ambos fenómenos. Además, si bien se estableció la necesidad de datos de tráfico (flujo vehicular), un conjunto de datos abierto de este tipo no se ha incluido inicialmente, por lo que su correlación se abordará mediante la asociación indirecta a zonas de alta densidad o, si fuera estrictamente necesario para la visualización y validación del modelo, mediante el uso de datos simulados o estimaciones estadísticas justificadas, únicamente con fines de modelado.
Tras este análisis, se han añadido dos preguntas que refinan el foco del proyecto: ¿Existe una correlación directa entre las áreas con mayor ruido y las zonas de mayor concentración de contaminantes atmosféricos? y ¿Qué patrones espaciales pueden observarse en los niveles de ruido y contaminación? Estas preguntas orientan las transformaciones ETL hacia el cruce de datos y la explotación de las dimensiones geográficas del almacén de datos.

Diseño Conceptual, Lógico y Físico del Almacén de Datos
Este apartado se centrará en documentar qué arquitectura se ha empleado para el almacén de datos, necesaria para estructurar correctamente los datos recogidos por zona o distrito y sus propiedades asociadas. El objetivo será crear un almacén de datos (o Data Warehouse), partiendo de un diseño conceptual hasta un diseño lógico y su diseño físico derivado.
4.1. Diseño Conceptual
En primer lugar, el diseño conceptual se encargará de recoger las necesidades del proyecto, la resolución de las preguntas iniciales, y establecer relaciones entre variables temporales, espaciales, meteorológicas, de ruido y contaminación, aunque sin entrar aún en implementaciones y tipos de datos. El diseño de este modelo se basará en un modelado dimensional donde se identificará un hecho, que en este caso será la medición ambiental como la métrica a analizar. Por otro lado, se incluirán una serie de dimensiones que permitirán desagregar los hechos y serán las siguientes: tiempo, estación, contaminante, distrito y zona. Este diseño ha sido posible realizarlo a través del servicio web de Draw.io:
foto, no?
4.2. Diseño Lógico
En segundo lugar, existirá un diseño lógico encargado de recoger las especificaciones incluidas en el diseño conceptual y traducirlas a un nuevo esquema, que en el caso de esta práctica será un Esquema Estrella, más simple y eficiente a la hora de realizar consultas. De forma análoga al diseño conceptual, se definirá una tabla de hechos central donde se almacenarán las métricas numéricas del proyecto y que estará formada únicamente a partir de las claves ajenas o foráneas del resto de tablas de dimensiones. De nuevo, se incluirán las tablas de dimensiones especificadas previamente, aunque en este caso serán diseñadas con los atributos preparados para su implementación, con columnas, claves primarias y ajenas y los tipos de datos. Sin embargo, este diseño aunque preparado para la implementación, aún se mantiene separado e independiente de un motor de bases de datos, acción abarcada en el siguiente diseño. Esta nueva sección ha sido desarrollada desde la herramienta MySQL Workbench, ya que permite un paso muy sencillo y fluido desde el diseño lógico al físico.
foto no se
4.3. Diseño Físico
Por último, el paso que resta tras la creación de los diseños conceptual y lógico sería el paso al diseño físico. Este diseño sería la implementación real del diseño lógico previamente diseñado, conteniendo tipos de datos exactos, índices, particiones, constraints y optimizaciones necesarias para el rendimiento y almacenamiento real de la base de datos. Este último diseño es fácil de completar desde el propio recurso de MySQL Workbench a partir del diseño lógico desde el apartado Menú → Database → Forward Engineer, recibiendo un script a revisar y ejecutar para finalmente crear y conectar un almacén de datos real, de ahí el nombre de diseño físico.

Limpiar, Transformar y Normalizar los Datos
Esta siguiente fase cuenta con una importancia vital para garantizar la calidad y coherencia de los datos antes de su uso final. Para conseguir esto, emplearemos Pentaho Data Integration como principal herramienta para la extracción de los datos de su origen, en este caso CSVs, la limpieza y normalización y la posterior integración de datos de distintas fuentes. Además, un paso fundamental del proceso sería el enriquecimiento de datos, donde se han añadido nuevas características de utilidad en pasos posteriores. Este flujo nos garantizará que los datos recopilados y procesados sean válidos y estén listos para el análisis y cualquier otro uso que se les quiera dar una vez cargados en el almacén correctamente.

El flujo diseñado estará compuesto por seis transformaciones específicas, cada una enfocada en una tarea distinta asociada al conjunto de datos con el que se trabaja (asociación de distritos y zonas, normalización, limpieza…), todas las cuales estarán finalmente orquestadas por un Job central que asegurará una ejecución secuencial y una gestión integral de todo el proceso, desde la extracción hasta la carga final.
Comenzando, tendremos una primera transformación encargada de construir y mantener la tabla de dimiensión Dim_Contaminante en el almacén de datos. Primeramente, recopilar todos los datos referentes a nombres de contaminantes, unidades de medida, tipo de compuesto…. además de algunos datos extraídos de fuentes externas (como son efecto sobre la salud o límite recomendado) y generará una clave que nos sirva como identificador único (id_Contaminante en el diseño lógico).  Por último, insertará toda la información en la tabla correspondiente, en este caso de la dimensión Contaminante en nuestra base de datos, y asegura que toda la información esté estandarizada. Resumidamente, cargará la descripción completa de los factores ambientales a un formato optimizado para el análisis.
A continuación tendremos nuestra segunda transformación, que tratará de cargar la dimensión Distrito en nuestro Data Warehouse. Dada la entrada de los CSV con los datos, se combinarán todos los valores necesarios y se eliminarán las filas sin información relevante o con valores nulos para preparar los campos. Toda la información extraída y aquella información adicional calculada será cargada en la tabla dim_distrito de la base de datos con un identificador asignado, en este caso id_Distrito, realizando las inserciones en base al nombre de los distritos.
Después, pasando a la tercera transformación, esta tendrá como objetivo principal generar la dimensión Tiempo para nuestro Data Warehouse a partir de una fecha de inicio y una cantidad de días. Esta transformación pretende obtener toda la información posible a partir de las fechas contenidas en los datos del CSV a transformar, generando nuevas columnas con datos como el año, el mes, el día de la semana, si es o no un día laborable… junto con un identificador id_Tiempo de autoincremento. Con estas acciones se generarán automáticamente las nuevas filas y columnas de datos y serán cargados en la tabla de destino en la base de datos.
En lo referido a la cuarta transformación, se tratará de cargar la dimensión Estación con los datos de las estaciones de contaminación de Valencia. El proceso seguirá un flujo de extracción, transformación y carga: en primer lugar, dada la entrada de los datos del CSV, se realizará una primera división del campo que contiene la latitud y la longitud para mantener estos valores en columnas separadas, ya que será de mayor utilidad para realizar cálculos y comparaciones. A continuación, se realizarán transformaciones en campos como el nombre para evitar conflictos con claves ajenas dentro de la dimensión y se tratará de manejar cualquier error en las búsquedas relacionadas con id_Distrito. Renombrando finalmente los campos que lo requieran para coincidir con el nombre de las columnas de la dimensión objetivo, podremos cargar los datos a la tabla de la dimensión de la base de datos.


Enriquecimiento y Transformación de Datos 
6.1. Propósito del Enriquecimiento de Datos
El enriquecimiento de datos es un paso fundamental en este proyecto dada su capacidad de maximizar la utilidad de los datos y el grafo RDF generado. De forma general, su principal objetivo será establecer una serie de vínculos semánticos entre los recursos locales del proyecto con todas las entidades equivalentes o relacionadas en cualquier base de datos externa, consiguiendo así un conjunto de datos enlazados (linked data). 

De esta manera, será posible facilitar, por un lado, que cualquier usuario o sistema de información sea capaz de localizar y comprender nuestros datos. Por otro lado, también conseguimos un acceso a la información más estandarizada y la facilidad de uso de otros servicios asociados como las visualizaciones geográficas.
6.2. Estrategia de Enlace de Datos con Wikidata
Para llevar a cabo esta tarea de enriquecimiento, se ha considerado apropiado orientarlo al ámbito geográfico, dada la naturaleza de los datos disponibles. Para ello, se eligió Wikidata como la fuente de datos principal dada su alta calidad, robustez y compatibilidad con los datos a enriquecer, que en este caso serán sobre los diferentes distritos de la ciudad de Valencia de los cuales se ha extraído información de contaminación ambiental y acústica.

La metodología a seguir comienza por la identificación de QID, un identificador único de Wikidata para cada uno de los distritos de Valencia y que permite realizar un mapeo inicial para asociar una descripción local con el conocimiento global de Wikidata. Seguido de ello, existirá un proceso estándar de buenas prácticas para la definición de vocabularios (o binding), donde será posible conseguir una sintaxis en formato Turtle (.ttl) que asocie un prefijo corto a una URI larga que permita escribir las propiedades como, por ejemplo, schema:name en lugar de utilizar la URI completa. Por último, habiendo modelado cada distrito con recursos del tipo schema:Place, para enlazar correctamente y de forma física la equivalencia semántica, utilizaremos la propiedad schema:sameAs, que nos permitirá hacer referencia a exactamente la misma entidad en su URI de Wikidata desde nuestro recurso local. De esta forma, se nos permitirá “saltar” a la página oficial de Wikidata de un distrito (aquel que estemos examinando) y podamos consultar cualquier información disponible, ya sean descripciones, imágenes u otras referencias externas.

Sumado a este proceso, se ha añadido un enlace con Wikidata en lo respectivo de la información geográfica de cada distrito, añadiendo un recurso del tipo schema:GeoCoordinates con las propiedades schema:hashMap y schema:geo. Con esta práctica, es posible recuperar la información geográfica completa y la generación de mapas interactivos que se basen únicamente en la información enlazada de los distritos de Valencia sin la necesidad de almacenar información redundante.

Con esto, la etapa de enriquecimiento nos asegura que el grado RDF de los distritos forme una parte real de la Web de Datos, elevando el proyecto más allá de un simple archivo de datos y convirtiéndolo en un recurso de información universalmente enlazable que sigue los principios de Datos Enlazados y que permite combinar nuestra información local con el amplio conocimiento de la Web Semántica.


Visualización
En esta etapa final del proyecto, se implementarán tres visualizaciones clave, cuyo objetivo será responder de forma atractiva alguna de las cuestiones planteadas al inicio de esta práctica. Concretamente, se han desarrollado tres visualizaciones, cada cual obtenida a partir de etapas distintas del proyecto.

En primer lugar, contamos con una visualización analítica, obtenida a partir de los datos limpios resultado de las transformaciones, limpieza y normalización de los datos completados con la herramienta de Pentaho Data Integration. El gráfico incluido a continuación mostrará una comparativa mediante dos gráficos específicos: por un lado se ofrece una comparativa de contaminación medioambiental entre días laborables y fin de semana mediante gráficos de violín. Además, se ofrece una profundización en la densidad de contaminación perteneciente a los días laborables con un gráfico de barras que permite apreciar la tendencia día a día de forma más clara.

A continuación, se ofrece una visualización geográfica en formato de mapa de calor basado en el ruido de la ciudad de Valencia. Esta visualización incluye un gradiente por zona ilustrando los niveles de contaminación acústica registrados y recogidos en nuestros datos, que han sido previamente procesados en Pentaho tal como se ha explicado.

Por último, habremos obtenido una visualización geográfica resultado de la etapa de transformación y enriquecimiento de datos. Una curiosidad de la obtención de esta visualización sería la facilidad con la cual se puede conseguir si se ha empleado Wikidata para el enriquecimiento y utilizando schema:sameAs, como es el caso de este proyecto, ya que existe esta opción explícita de generación de mapas a través de consultas SPARQL al enlazar los datos a sus QIDs correspondientes. Esta herramienta ha sido complementada de forma que obtenidos los distritos y el mapa gracias a Wikidata, se ha graficado los distritos en el mapa siguiendo la información geométrica de cada uno y añadido un sistema de coloreado según la densidad de contaminación medida en las estaciones pertenecientes a cada distrito. Además, se aprecia un carácter interactivo donde haciendo clic sobre cada distrito dibujado se ofrece información adicional (como fotos y medidas contaminantes) extraída de Wikidata y de los propios datos.
